{{- if and (not .Values.global.agtK8Config.withPlugins.vln.remote) (.Values.global.agtK8Config.withPlugins.vln.enabled)) -}}
apiVersion: v1
kind: Pod
metadata:
  name: hello-agt-container-usage
spec:
  restartPolicy: Always
  containers:
    {{- include "agent.plugins" (merge (dict "contrDictContrName" "agt-plugin-contr") .) | nindent 4 }}
    - name: nginx-container
      image: nginx
      command: ["/bin/sh"]
      args: ["-c", "echo Hello from the nginx container"]
  initContainers:
    - name: debian-container
      # debian image version used 18.09.7
      image: debian
      # run ip addr cmd to register the ips
      command: ["/bin/sh"]
      # to add signle ip to loopback use - ip addr add <ip> dev lo e.g. ip addr add 10.0.1.8 dev lo
      # to add ips with mask use - ip add add <ip>/<mask> dev lo e.g. ip a add 192.168.1.200/24 dev lo
      # to check if ips are added to loopback use command ip addr show
      args: ["-c", "echo Hello from the debian container; sleep 5; ip addr add 10.0.1.8 dev lo; sleep 5; ip a add 192.168.1.200/24 dev lo; sleep 5; ip addr show"]
{{- end -}}
